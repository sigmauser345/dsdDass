-- Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UIS = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local LocalPlayer = Players.LocalPlayer

-- GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RevolverVoidDashUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = CoreGui

local visible = true

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 320, 0, 360)
frame.Position = UDim2.new(0.4, 0, 0.4, 0)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 25)
title.Position = UDim2.new(0, 0, 0, 5)
title.BackgroundTransparency = 1
title.Text = "Chaos Gui"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(220, 220, 220)
title.Parent = frame

local textBox = Instance.new("TextBox")
textBox.Size = UDim2.new(1, -20, 0, 35)
textBox.Position = UDim2.new(0, 10, 0, 35)
textBox.PlaceholderText = "Enter Display Name"
textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
textBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
textBox.ClearTextOnFocus = false
textBox.Font = Enum.Font.Gotham
textBox.TextSize = 18
textBox.Parent = frame
Instance.new("UICorner", textBox).CornerRadius = UDim.new(0, 6)

-- LoopRevolver Button
local loopButton = Instance.new("TextButton")
loopButton.Size = UDim2.new(1, -20, 0, 40)
loopButton.Position = UDim2.new(0, 10, 0, 80)
loopButton.Text = "Start LoopRevolver"
loopButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
loopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
loopButton.Font = Enum.Font.GothamBold
loopButton.TextSize = 18
loopButton.Parent = frame
Instance.new("UICorner", loopButton).CornerRadius = UDim.new(0, 6)

-- Void Player Section
local voidLabel = Instance.new("TextLabel")
voidLabel.Size = UDim2.new(1, 0, 0, 20)
voidLabel.Position = UDim2.new(0, 0, 0, 125)
voidLabel.Text = "Void Player"
voidLabel.BackgroundTransparency = 1
voidLabel.Font = Enum.Font.GothamBold
voidLabel.TextSize = 16
voidLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
voidLabel.Parent = frame

local voidButton = Instance.new("TextButton")
voidButton.Size = UDim2.new(1, -20, 0, 40)
voidButton.Position = UDim2.new(0, 10, 0, 145)
voidButton.Text = "Void"
voidButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
voidButton.TextColor3 = Color3.fromRGB(255, 255, 255)
voidButton.Font = Enum.Font.GothamBold
voidButton.TextSize = 18
voidButton.Parent = frame
Instance.new("UICorner", voidButton).CornerRadius = UDim.new(0, 6)

-- InfDash Section
local dashLabel = Instance.new("TextLabel")
dashLabel.Size = UDim2.new(1, 0, 0, 20)
dashLabel.Position = UDim2.new(0, 0, 0, 190)
dashLabel.Text = "Infinite Dash"
dashLabel.BackgroundTransparency = 1
dashLabel.Font = Enum.Font.GothamBold
dashLabel.TextSize = 16
dashLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
dashLabel.Parent = frame

local infDashButton = Instance.new("TextButton")
infDashButton.Size = UDim2.new(1, -20, 0, 40)
infDashButton.Position = UDim2.new(0, 10, 0, 210)
infDashButton.Text = "Activate InfDash"
infDashButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
infDashButton.TextColor3 = Color3.fromRGB(255, 255, 255)
infDashButton.Font = Enum.Font.GothamBold
infDashButton.TextSize = 18
infDashButton.Parent = frame
Instance.new("UICorner", infDashButton).CornerRadius = UDim.new(0, 6)

-- EmrGiver Section
local dashLabel = Instance.new("TextLabel")
dashLabel.Size = UDim2.new(1, 0, 0, 20)
dashLabel.Position = UDim2.new(0, 0, 0, 253)
dashLabel.Text = "Emerald Giver"
dashLabel.BackgroundTransparency = 1
dashLabel.Font = Enum.Font.GothamBold
dashLabel.TextSize = 16
dashLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
dashLabel.Parent = frame

-- EmrGiver Button
local emrButton = Instance.new("TextButton")
emrButton.Size = UDim2.new(1, -20, 0, 40)
emrButton.Position = UDim2.new(0, 10, 0, 273)
emrButton.Text = "Activate EmrGiver"
emrButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
emrButton.TextColor3 = Color3.fromRGB(255, 255, 255)
emrButton.Font = Enum.Font.GothamBold
emrButton.TextSize = 18
emrButton.Parent = frame
Instance.new("UICorner", emrButton).CornerRadius = UDim.new(0, 6)

-- Toggle label
local toggleLabel = Instance.new("TextLabel")
toggleLabel.Size = UDim2.new(1, 0, 0, 20)
toggleLabel.Position = UDim2.new(0, 0, 0, 320)
toggleLabel.Text = "F1 = Toggle GUI"
toggleLabel.BackgroundTransparency = 1
toggleLabel.Font = Enum.Font.Gotham
toggleLabel.TextSize = 14
toggleLabel.TextColor3 = Color3.fromRGB(170, 170, 170)
toggleLabel.Parent = frame

-- Logic variables
local active = false
local revolverName = "Kawaii Revolver"
local damageInterval = 0.54

-- LoopRevolver logic
local function getRevolver()
	local char = LocalPlayer.Character
	local backpack = LocalPlayer:FindFirstChildOfClass("Backpack")
	if not char or not backpack then return nil end

	local tool = char:FindFirstChild(revolverName)
	if tool and tool:FindFirstChild("DamageRemote") then return tool end

	local toolInBackpack = backpack:FindFirstChild(revolverName)
	if toolInBackpack and toolInBackpack:FindFirstChild("DamageRemote") then
		toolInBackpack.Parent = char
		return toolInBackpack
	end

	return nil
end

local function getTargetHumanoid(partial)
	partial = partial:lower()
	for _, p in pairs(Players:GetPlayers()) do
		if p ~= LocalPlayer and p.DisplayName:lower():find(partial, 1, true) then
			local h = p.Character and p.Character:FindFirstChildWhichIsA("Humanoid")
			if h then return h, p.DisplayName end
		end
	end
end

loopButton.MouseButton1Click:Connect(function()
	active = not active
	if active then
		local humanoid, fullName = getTargetHumanoid(textBox.Text)
		if not humanoid then warn("Player not found.") return end
		textBox.Text = fullName
		loopButton.Text = "Stop LoopRevolver"
		loopButton.BackgroundColor3 = Color3.fromRGB(40, 200, 40)

		task.spawn(function()
			local dead = false
			while active do
				local tool = getRevolver()
				local remote = tool and tool:FindFirstChild("DamageRemote")
				local target, _ = getTargetHumanoid(fullName)
				if remote and target then
					if target.Health > 0 then
						remote:FireServer(target)
					elseif not dead then
						dead = true
						game.StarterGui:SetCore("SendNotification", {
							Title = "LoopRevolver",
							Text = fullName .. " is dead!",
							Duration = 3
						})
						repeat task.wait(1)
							target, _ = getTargetHumanoid(fullName)
							if target and target.Health > 0 then dead = false break end
						until not active
					end
				end
				task.wait(damageInterval)
			end
		end)
	else
		loopButton.Text = "Start LoopRevolver"
		loopButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
	end
end)

-- Void button
voidButton.MouseButton1Click:Connect(function()
	local char = LocalPlayer.Character
	if char and char:FindFirstChild("HumanoidRootPart") then
		char:MoveTo(Vector3.new(0, -497.8, 0))
	end
end)

-- InfDash logic
local infDashActive = false
local originalWait

infDashButton.MouseButton1Click:Connect(function()
	infDashActive = not infDashActive
	if infDashActive then
		infDashButton.Text = "Deactivate InfDash"
		infDashButton.BackgroundColor3 = Color3.fromRGB(40, 200, 40)
		originalWait = hookfunction(wait, function(seconds)
			if seconds == 2 then return end
			return originalWait(seconds)
		end)
	else
		infDashButton.Text = "Activate InfDash"
		infDashButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
		if originalWait then
			hookfunction(wait, originalWait)
		end
	end
end)

-- EmrGiver logic
local CLICK_POSITION = Vector2.new(837, 563)
local emrToggled = false
local hasClicked = false

local function click()
	VirtualInputManager:SendMouseButtonEvent(CLICK_POSITION.X, CLICK_POSITION.Y, 0, true, game, 0)
	VirtualInputManager:SendMouseButtonEvent(CLICK_POSITION.X, CLICK_POSITION.Y, 0, false, game, 0)
end

local function runClicking()
	if hasClicked then return end
	hasClicked = true
	for i = 1, 2 do
		click()
		task.wait(0.4)
	end
end

emrButton.MouseButton1Click:Connect(function()
	emrToggled = not emrToggled
	if emrToggled then
		emrButton.Text = "Deactivate EmrGiver"
		emrButton.BackgroundColor3 = Color3.fromRGB(40, 200, 40)
		runClicking()
	else
		emrButton.Text = "Activate EmrGiver"
		emrButton.BackgroundColor3 = Color3.fromRGB(200, 40, 40)
	end
end)

LocalPlayer.CharacterAdded:Connect(function()
	if emrToggled then
		task.wait(1)
		hasClicked = false
		runClicking()
	end
end)

-- F1 to toggle GUI
UIS.InputBegan:Connect(function(input, processed)
	if processed then return end
	if input.KeyCode == Enum.KeyCode.F1 then
		visible = not visible
		screenGui.Enabled = visible
	end
end)
